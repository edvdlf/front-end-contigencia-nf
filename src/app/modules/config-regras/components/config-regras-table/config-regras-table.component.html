<div class="vetorit-card">
    <p-card styleClass="shadow-3  text-orange-500" header="Regras">
      
      <div class="card">
        <p-table
          class="vetorit-table"
          #regrasTable
          [value]="regras"
          [rows]="20"
          [paginator]="true"
          [globalFilterFields]="['grupo', 'id']"
          [tableStyle]="{ 'min-width': '50rem' }"
          styleClass="p-datatable-gridlines p-datatable-striped p-datatable-sm"
          [rowHover]="true"
          [showCurrentPageReport]="true"
          dataKey="id"
          [rowsPerPageOptions]="[5, 10, 20, 50, 100]"
          currentPageReportTemplate="Mostrando {first} de {last} de {totalRecords} Regras"
        >
          <!--ng-template pTemplate="caption">
            <div class="flex align-items-center justify-content-between">
              Listagem de regras
            </div>
          </ng-template-->
          <ng-template pTemplate="caption">
  <div class="flex align-items-center justify-content-between gap-2 flex-wrap">
    <div class="flex align-items-center gap-2">
      <span class="text-900 font-semibold">Listagem de regras</span>
      <p-tag
        [value]="(regras?.length || 0) + ' registros'"
        severity="info"
        styleClass="ml-2"
      ></p-tag>
    </div>

    <div class="flex align-items-center gap-2">
      <p-button
        label="Nova Regra"
        icon="pi pi-plus"
        styleClass="p-button-sm"
        (click)="add.emit()"
        data-cy="regras-btn-nova"
      ></p-button>

      <p-button
        label="Exportar"
        icon="pi pi-file-excel"
        styleClass="p-button-sm"
        severity="secondary"
        (click)="exportExcel()"
        [disabled]="!regras?.length"
        data-cy="regras-btn-exportar"
      ></p-button>
      </div>
      </div>
      </ng-template>

          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="id">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    Id
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="id"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="id"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th pSortableColumn="ordem" style="width: 20rem">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    Ordem
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="ordem"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="ordem"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th pSortableColumn="descricao">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    Descrição
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="descricao"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="descricao"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th style="width: 10rem" pSortableColumn="dataFormatada">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    Data
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="dataFormatada"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="dataFormatada"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th style="width: 12rem" pSortableColumn="classTrib">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    Classificação Tributária
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="classTrib"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="classTrib"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th style="width: 12rem" pSortableColumn="cst">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    CST
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="cst"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="cst"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th style="width: 12rem" pSortableColumn="status">
                <div class="flex justify-content-between align-items-center">
                  <div class="flex justify-content-between align-items-center">
                    Status
                  </div>
                  <div class="flex justify-content-between align-items-center">
                    <p-sortIcon field="status"></p-sortIcon>
                    <p-columnFilter
                      type="text"
                      field="status"
                      display="menu"
                      matchMode="contains"
                      [showMatchModes]="false"
                      [showOperator]="false"
                      [showAddButton]="false"
                    ></p-columnFilter>
                  </div>
                </div>
              </th>
              <th>
                    <div class="flex justify-content-center align-items-center">Editar</div>
              </th>
              <th>
                    <div class="flex justify-content-center align-items-center">Excluir</div>
              </th>
              <th>
                    <div class="flex justify-content-center align-items-center">Condições</div>
              </th>
            </tr>
          </ng-template>
          <!--ng-template pTemplate="body" let-dados>
            <tr>
              
              
            </tr>
          </ng-template-->
          <ng-template pTemplate="body" let-regra let-editing="editing" let-ri="rowIndex">
            <tr [pEditableRow]="regra">
                <td style="text-align: center">{{ regra.id }}</td>
                <td style="text-align: center">{{ regra.ordem }}</td>
                <td style="text-align: center">{{ regra.descricao }}</td>
                <td style="text-align: center">{{ regra.dataFormatada }}</td>
                <td style="text-align: center">{{ regra.classTrib }}</td>
                <td style="text-align: center">{{ regra.cst }}</td>
                <!--td style="text-align: center">{{ regra.status }}</td-->
                <td data-cy="usuarios-cell-ativo">
                <p-tag
                [value]="getStatusText(regra.status)"
                [style]="{
                  'background-color': getStatusColor(regra.status),
                  color: 'white'
                 }"
                data-cy="usuarios-tag-ativo"
          ></p-tag>
        </td>

                <td style="text-align: center">
                    <p-button icon="pi pi-file-edit" styleClass="p-button-rounded p-button-primary p-button-text"
                        pTooltip="Editar" (click)="editar.emit(regra)">
                    </p-button>
                                
                </td>
                <td style="text-align: center">
                   
                    <p-button icon="pi pi-trash" styleClass="p-button-rounded p-button-danger p-button-text"
                        pTooltip="Apagar" (click)="excluir.emit(regra)">
                    </p-button>
                                        
                </td>
                <td style="text-align: center">
                    
                    <p-button icon="pi pi-table" styleClass="p-button-rounded p-button-warning p-button-text"
                        pTooltip="Condições" (click)="condicoes.emit(regra)">
                    </p-button>                    
                </td>
            </tr>
        </ng-template>
          
        </p-table>
      </div>
    </p-card>
</div>